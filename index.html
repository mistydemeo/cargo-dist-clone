<!DOCTYPE html>
<html lang="en" id="oranda" class="dark axo">
  <head>
    <title>cargo-dist</title>
    
    
      <link rel="icon" href="/cargo-dist/favicon.ico" />
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
      <meta name="description" content="Shippable application packaging for Rust" />
      <meta property="og:description" content="Shippable application packaging for Rust" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="cargo-dist" />
    
      <meta name="twitter:card" content="summary_large_image" />
      <meta property="og:image" content="https://www.axo.dev/meta_small.jpeg" />
    
    
      <meta property="og:image:alt" content="axo" />
    
    
      <meta name="twitter:creator" content="@axodotdev" />
      <meta name="twitter:site" content="@axodotdev" />
    
    <meta http-equiv="Permissions-Policy" content="interest-cohort=()" />
    <link rel="stylesheet" href="/cargo-dist/oranda-v0.6.1.css" />
    
    
  </head>
  <body>
    <div class="container">
      <div class="page-body">
        
          <div class="repo_banner">
            <a href="https://github.com/mistydemeo/cargo-dist-clone">
              <div class="github-icon" aria-hidden="true"></div>
              Check out our GitHub!
            </a>
          </div>
        

        <main>
          <header>
            
            <h1 class="title">cargo-dist</h1>
            
  <nav class="nav">
    <ul>
      <li><a href="/cargo-dist/">Home</a></li>

      

      
        <li><a href="/cargo-dist/artifacts/">Install</a></li>
      

      
        <li><a href="/cargo-dist/book/">Docs</a></li>
      

      

      
        <li><a href="/cargo-dist/changelog/">Changelog</a></li>
      
    </ul>
  </nav>

          </header>

          


    <div class="oranda-hide">
<h1><code>cargo-dist</code></h1>
</div>
<p><a href="https://crates.io/crates/cargo-dist" rel="noopener noreferrer"><img src="https://img.shields.io/crates/v/cargo-dist.svg" alt="crates.io"></a>
<a href="https://docs.rs/cargo-dist" rel="noopener noreferrer"><img src="https://docs.rs/cargo-dist/badge.svg" alt="docs"></a>
<a href="https://github.com/axodotdev/cargo-dist/actions/workflows/ci.yml" rel="noopener noreferrer"><img src="https://github.com/axodotdev/cargo-dist/workflows/Rust%20CI/badge.svg?branch=main" alt="Rust CI"></a></p>
<p><em>cargo-dist distributes your binaries</em></p>
<p>The TL;DR is that with cargo-dist setup, just doing this:</p>
<pre style="background-color:#263238;"><span style="color:#82aaff;">git commit</span><span style="color:#89ddff;"> -</span><span style="color:#f78c6c;">am </span><span style="color:#89ddff;">"</span><span style="color:#c3e88d;">release: 0.2.0</span><span style="color:#89ddff;">"
</span><span style="color:#82aaff;">git tag </span><span style="color:#89ddff;">"</span><span style="color:#c3e88d;">v0.2.0</span><span style="color:#89ddff;">"
</span><span style="color:#82aaff;">git push
</span><span style="color:#82aaff;">git push</span><span style="color:#89ddff;"> --</span><span style="color:#f78c6c;">tags
</span></pre>

<p>Will make <a href="https://github.com/axodotdev/axolotlsay/releases/tag/v0.2.0" rel="noopener noreferrer">this Github Release</a>:</p>
<p>Or if you're using <a href="https://opensource.axo.dev/oranda/" rel="noopener noreferrer">oranda</a>, you'll get <a href="https://opensource.axo.dev/axolotlsay/" rel="noopener noreferrer">this website</a>.</p>
<h2>Plan, Build, Host, Publish, Announce</h2>
<p>Cutting releases of your apps and distributing binaries for them has a lot of steps, and cargo-dist is quickly growing to try to cover them all!</p>
<p>To accomplish this, cargo-dist functionality can be broken up into two parts:</p>
<ul>
<li>building (<strong>planning</strong> the release; <strong>building</strong> binaries and installers)</li>
<li>distributing (<strong>hosting</strong> artifacts; <strong>publishing</strong> packages; <strong>announcing</strong> releases)</li>
</ul>
<p>The build functionality can be used on its own if you just want some tarballs and installers, but everything really comes together when you use the distribution functionality too.</p>
<h2>Building</h2>
<p>As a build tool, cargo-dist can do the following:</p>
<ul>
<li>Pick good build flags for "shippable binaries"</li>
<li>Make <a href="https://opensource.axo.dev/cargo-dist/book/artifacts/archives.html" rel="noopener noreferrer">tarballs</a> and <a href="https://opensource.axo.dev/cargo-dist/book/installers/index.html" rel="noopener noreferrer">installers</a> for the resulting binaries</li>
<li>Generate <a href="https://opensource.axo.dev/cargo-dist/book/reference/schema.html" rel="noopener noreferrer">machine-readable manifests</a> so other tools can understand the results</li>
</ul>
<p>That's a short list because "we make <a href="https://opensource.axo.dev/cargo-dist/book/installers/index.html" rel="noopener noreferrer">installers</a>" is doing a lot of heavy lifting. Each installer could be (and sometimes is!) an entire standalone tool with its own documentation and ecosystem.</p>
<h2>Distributing</h2>
<p>As a distribution tool, cargo-dist gets to flex its biggest superpower: <strong>it generates <a href="https://opensource.axo.dev/cargo-dist/book/ci/index.html" rel="noopener noreferrer">its own CI scripts</a></strong>. For instance, enabling <a href="https://opensource.axo.dev/cargo-dist/book/ci/github.html" rel="noopener noreferrer">GitHub CI</a> with <code>cargo dist init</code> will generate release.yml, which implements the full pipeline of plan, build, host, publish, announce:</p>
<ul>
<li>Plan
<ul>
<li>Waits for you to push a git tag for a new version (v1.0.0, my-app-v1.0.0, my-app/1.0.0, ...)</li>
<li>Selects what apps in your workspace to announce new releases for based on that tag</li>
<li>Generates <a href="https://opensource.axo.dev/cargo-dist/book/reference/schema.html" rel="noopener noreferrer">a machine-readable manifest</a> with changelogs and build plans</li>
</ul>
</li>
<li>Build
<ul>
<li>Spins up machines for each platform you support</li>
<li>Builds your <a href="https://opensource.axo.dev/cargo-dist/book/artifacts/archives.html" rel="noopener noreferrer">binaries and tarballs</a></li>
<li>Builds <a href="https://opensource.axo.dev/cargo-dist/book/installers/index.html" rel="noopener noreferrer">installers</a> for your binaries</li>
</ul>
</li>
<li>Publish:
<ul>
<li>Uploads to package managers</li>
</ul>
</li>
<li>Host + Announce:
<ul>
<li>Creates (or edits) a GitHub Release</li>
<li>Uploads build artifacts to the Release</li>
<li>Adds relevant release notes from your RELEASES/CHANGELOG</li>
</ul>
</li>
</ul>
<h1>Read The Book!</h1>
<p>We've got all the docs you need over at the <a href="https://axodotdev.github.io/cargo-dist/book/" rel="noopener noreferrer">cargo-dist book</a>!</p>
<ul>
<li><a href="https://opensource.axo.dev/cargo-dist/book/introduction.html" rel="noopener noreferrer">Introduction</a></li>
<li><a href="https://opensource.axo.dev/cargo-dist/book/install.html" rel="noopener noreferrer">Install</a></li>
<li><a href="https://opensource.axo.dev/cargo-dist/book/way-too-quickstart.html" rel="noopener noreferrer">Way-Too-Quickstart</a></li>
<li><a href="https://opensource.axo.dev/cargo-dist/book/workspaces/index.html" rel="noopener noreferrer">Workspaces Guide</a></li>
<li><a href="https://opensource.axo.dev/cargo-dist/book/reference/index.html" rel="noopener noreferrer">Reference</a></li>
</ul>
<div class="oranda-hide">
<h1>Contributing</h1>
<h2>Updating Snapshots</h2>
<p>cargo-dist's tests rely on <a href="https://crates.io/crates/cargo-insta" rel="noopener noreferrer">cargo-insta</a> for snapshot testing various
outputs. This allows us to both catch regressions and also more easily review UI/output changes. If a snapshot
test fails, you will need to use the <code>cargo insta</code> CLI tool to update them:</p>
<pre style="background-color:#263238;"><span style="color:#82aaff;">cargo install cargo-insta
</span></pre>

<p>Once installed, you can review and accept the changes with:</p>
<pre style="background-color:#263238;"><span style="color:#82aaff;">cargo insta review
</span></pre>

<p>If you know you like the changes, just use <code>cargo insta accept</code> to auto-apply all changes.</p>
<p>(If you introduced brand-new snapshot tests you will also have to <code>git add</code> them!)</p>
<blockquote>
<p>NOTE: when it succeeds, cargo-dist-schema's <code>emit</code> test will actually commit the results back to disk to <code>cargo-dist-schema/cargo-dist-schema.json</code> as a side-effect. This is a janky hack to make sure we have that stored and up to date at all times (the test also uses an insta snapshot but insta snapshots include an extra gunk header so it's not something we'd want to link end users). The file isn't even used for anything yet, I just want it to Exist because it seems useful and important. In the future we might properly host it and have our outputs link it via a <code>$schema</code> field.</p>
</blockquote>
<h2>Cutting Releases</h2>
<p>cargo-dist is self-hosting, so you just need to push a git-tag with the right format to "do" a release. Of course there's lots of other tedious tasks that come with updating a release, and we use cargo-release to handle all those mechanical details of updating versions/headings/tags. See <a href="https://opensource.axo.dev/cargo-dist/book/cargo-release-guide.html#using-cargo-release-with-pull-requests" rel="noopener noreferrer">these sections of the docs for the release workflow we use</a>.</p>
<p>TL;DR:</p>
<ul>
<li>Update CHANGELOG.md's "Unreleased" section to include all the release notes you want</li>
<li>run cargo-release as described in the docs</li>
<li>..you're done!</li>
</ul>
<p>Note that we've wired up cargo-dist and cargo-release to understand the "Unreleased" heading so you
should never edit that name, the tools will update it as needed.</p>
<p>If that releases succeeds, we recommend updating the bootstrap version of cargo-dist as a follow up:</p>
<ul>
<li>install the version of cargo-dist you just released on your system</li>
<li>run <code>cargo dist init --yes</code></li>
<li>commit "chore: update bootstrap dist to ..."</li>
</ul>
<p>Note that as a consequence of the way we self-host, cargo-dist's published artifacts will always be built/generated by a previous version of itself. This can be problematic if you make breaking changes to cargo-dist-schema's format... so don't! Many things in the schema are intentionally optional to enable forward and backward compatibility, so this should hopefully work well!</p>
</div>



        </main>
      </div>

      <footer>
        
          <a href="https://github.com/mistydemeo/cargo-dist-clone"><div class="github-icon" aria-hidden="true"></div></a>
        
        <span>
          cargo-dist, MIT OR Apache-2.0
        </span>
      </footer>
    </div>

    
      <script defer="true" data-domain="opensource.axo.dev" src="https://plausible.io/js/script.js"></script>
    
    

    

    <script src="/cargo-dist/artifacts.js"></script>


  </body>
</html>